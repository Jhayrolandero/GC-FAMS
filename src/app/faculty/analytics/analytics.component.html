<app-loading-screen *ngIf="isLoading"></app-loading-screen>

<div class="p-5 flex flex-col gap-y-3 text-blue" *ngIf="!isLoading">
    <div
        class="bg-white shadow-main bg-opacity-70 w-full rounded-[15px] flex flex-col tablet:flex-row tablet:justify-between items-center px-5">
        <h1 class="font-Poppins font-semibold text-[2.5rem] py-2">
            Analytics
        </h1>
    </div>

    <div class="w-full h-[450px] flex flex-row gap-x-3 items-center">
        <div
            class="bg-white shadow w-[20%] h-[100%] rounded-[15px] overflow-hidden flex flex-col items-center shadow-main">
            <div class="h-[50%] w-full flex justify-center relative">
                <img class="object-cover h-full w-full" [src]="facultyProfile.profile_image"
                    onerror="this.onerror=null; this.src='../../../assets/profiles/user.png'" />
                <div
                    class="absolute w-full h-full hover:inset-0 bg-gradient-to-t from-gray-900 to-transparent opacity-50 hover:opacity-80 duration-300">
                </div>
            </div>
            <div class="h-[50%] w-[100%]">
                <h1 class="font-Poppins font-bold text-[1.6rem] text-center">
                    {{ facultyProfile.first_name }} {{ facultyProfile.middle_name }}
                    {{ facultyProfile.last_name }}
                </h1>
                <div class="flex flex-col space-y-3">
                    <div class="flex flex-row items-center">
                        <img class="px-2" src="../../../assets/faculty-view-icons/envelope.png" />
                        <p class="font-Roboto font-extralight">
                            {{ facultyProfile.email }}
                        </p>
                    </div>
                    <div class="flex flex-row items-center">
                        <img class="px-2" src="../../../assets/faculty-view-icons/graduation.png" />
                        <p class="font-Roboto font-extralight">
                            Bachelor of Science in Computer Science
                        </p>
                    </div>
                    <div class="flex flex-row items-center">
                        <img class="px-2" src="../../../assets/faculty-view-icons/contacts.png" />
                        <p class="font-Roboto font-extralight">
                            21 Units Currently Handled
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white shadow w-[80%] h-[100%] rounded-[15px] shadow-main">
            <div class="px-4">
                <h1 class="font-Poppins font-semibold text-[2.5rem] py-2">
                    Milestone Calendar
                </h1>
                <app-faculty-milestone-calendar></app-faculty-milestone-calendar>
                <h4 class="font-Poppins font-semibold text-[1.4rem] py-2">
                    Milestone History
                </h4>
            </div>
        </div>
    </div>


    <div class="w-full h-full rounded-[15px] flex flex-row gap-x-3">
        <div class="bg-white shadow-main w-full rounded-[15px] grid grid-cols-3 px-4 py-2 flex-1">
            <div class="col-span-2">
                <h4 class="text-[2.5rem] font-Poppins font-semibold m-2 leading-[1]">
                    Evaluation Graph
                </h4>
                <div class="bg-red-200 w-[70%] flex justify-center">
                    <app-pie-chart [data]="evalScoreCategory"></app-pie-chart>
                </div>
            </div>
            <div class="border-s-2 border-black flex flex-col justify-center items-center gap-4 px-6">
                <h4 class="text-[2.5rem] font-Poppins font-semibold m-0 leading-[1]">
                    Evaluation Score
                </h4>
                <p class="text-[128px] m-0 font-bold leading-[1]">
                    {{ selectedSem.evalAverage }}
                </p>
                <small class="text-[16px] text-[#1E7242] font-semibold">
                    As of {{ selectedSem.semester }}@if(selectedSem.semester == 1){st}
                    @else if (selectedSem.semester == 2) {nd} A.Y.
                    {{ selectedSem.evaluation_year }}-{{
                    +selectedSem.evaluation_year + 1
                    }}</small>
                <div class="flex gap-4 w-full justify-evenly" *ngFor="let evalItem of evalScoreCategory">
                    <span [ngStyle]="{ 'background-color': evalItem.bgColor }" class="h-full aspect-square"></span>
                    <p class="text-[16px] font-semibold">{{ evalItem.name }}</p>
                    <p class="text-[24px] font-semibold">{{ evalItem.value }}</p>
                </div>
            </div>
        </div>
        <div class="flex flex-col gap-4">
            <div class="bg-white shadow-main w-[360px] flex-1 rounded-[15px] overflow-hidden">
                <h4 class="text-white text-[24px] bg-blue text-center py-2 font-semibold">
                    Units Handled
                </h4>
                <div class="flex flex-col justify-center items-center">
                    <p class="text-[120px] font-bold leading-[1]">{{unit}}</p>
                    <small class="text-[16px] text-[#3a8358] font-semibold">{{schedules.length}} Classes</small>
                </div>
            </div>
            <div class="bg-white shadow-main w-[360px] flex-1 rounded-[15px] overflow-hidden">
                <h4 class="text-white text-[24px] bg-blue text-center py-2 font-semibold">
                    Total Awards & Certificates
                </h4>
                <div class="flex flex-col justify-center items-center">
                    <p class="text-[120px] font-bold leading-[1]">22</p>
                    <small class="text-[16px] text-[#3a8358] font-semibold"></small>
                </div>
            </div>
        </div>
    </div>
</div>